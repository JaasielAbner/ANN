import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [-4.1766, -4.1074, -4.0517, -3.9645, -3.8292, -3.7615, -3.6673, -3.5844, -3.5043, -3.3948, -3.2812, -3.234, -3.138, -3.0573, -2.9342, -2.8568, -2.7486, -2.7329, -2.6425, -2.5521, -2.4217, -2.3249, -2.2459, -2.1837, -2.121, -2.0012, -1.8931, -1.8171, -1.7637, -1.5986, -1.5851, -1.4959, -1.3839, -1.321, -1.167, -1.1337, -0.9891, -0.9368, -0.8475, -0.7252, -0.6398, -0.5543, -0.5138, -0.4118, -0.2912, -0.1791, -0.1547, -0.0417, 0.0274, 0.1004, 0.1795, 0.3092, 0.3861, 0.5027, 0.5884, 0.6602, 0.7392, 0.8215, 0.8969, 0.9932, 1.1432, 1.2168, 1.2783, 1.3513, 1.4335, 1.5402, 1.6317, 1.7666, 1.7784, 1.8595, 2.0044, 2.1196, 2.1799, 2.2778, 2.3772, 2.3979, 2.4797, 2.5819, 2.6929, 2.7926, 2.9022, 2.9932, 3.0962, 3.1128, 3.2068, 3.329, 3.3955, 3.5408, 3.6235, 3.6479, 3.7703, 3.8253, 3.9024, 4.0713, 4.1353, 4.1717]
y =  [2.9168, 3.8145, 4.5128, 6.3678, 5.832, 6.0892, 6.4923, 6.7542, 7.0411, 7.099, 7.0151, 7.0486, 7.1942, 7.0598, 6.6582, 5.0134, 6.2952, 6.3123, 6.1795, 6.8968, 5.9645, 5.7373, 5.5364, 5.4996, 4.9684, 5.2001, 5.003, 4.4254, 4.7182, 4.2677, 4.3268, 4.3831, 4.1616, 4.4176, 4.2553, 4.0761, 4.3109, 4.3468, 4.2885, 4.4165, 5.8221, 5.3492, 4.2916, 4.6164, 4.7797, 5.6082, 4.6552, 6.5588, 5.128, 5.8492, 5.2979, 5.3709, 4.7448, 7.4998, 4.1376, 5.8579, 5.5941, 5.8043, 5.7307, 5.8735, 5.7191, 6.0515, 5.8115, 5.9986, 5.5157, 5.4679, 5.4816, 5.4359, 5.1082, 5.2376, 5.2256, 4.2039, 4.1842, 4.3645, 4.7409, 4.0224, 3.966, 3.9943, 4.2084, 3.3577, 3.4095, 3.11, 2.8218, 1.9239, 2.0106, 2.807, 3.0712, 3.0054, 1.8246, 3.5166, 5.3163, 4.1422, 3.5222, 4.6283, 6.2755, 6.2894]

a0, a1, a2, a3, a4, a5 = best_poly(x, y, 5)

print(f'{a0 = } , {a1 = }, {a2 = }, {a3 = }, {a4 = }, {a5 = }')