import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [0.0453, 0.1836, 0.257, 0.434, 0.5079, 0.6357, 0.7042, 0.9255, 0.9951, 1.0762, 1.1888, 1.333, 1.4474, 1.5275, 1.7323, 1.8134, 1.8888, 1.9994, 2.1132, 2.2735, 2.3641, 2.474, 2.5875, 2.6987, 2.8199, 2.9178, 3.0408, 3.2484, 3.2917, 3.4854, 3.5686, 3.6552, 3.8149, 3.9492, 4.0198, 4.1401, 4.2304, 4.3405, 4.5306, 4.5437, 4.6977, 4.7901, 4.9489, 5.0438, 5.2224, 5.289, 5.3971, 5.5713, 5.6764, 5.7701, 5.8239, 5.9416, 6.0683, 6.2235, 6.2906, 6.4621, 6.6017, 6.7013, 6.838, 6.9677, 6.9847, 7.1076, 7.3039, 7.3591, 7.5345, 7.626, 7.725, 7.9054, 7.9754, 8.1339, 8.1638, 8.2825, 8.4229, 8.5788, 8.6808, 8.7777, 8.9177, 9.0167, 9.1024, 9.2726, 9.349, 9.4469, 9.6051, 9.6833, 9.8608, 9.9302]
y = [5.0313, 4.95, 5.0157, 4.566, 4.9048, 4.4467, 5.5696, 4.2682, 4.3255, 5.6157, 4.3505, 4.4095, 4.0315, 3.3464, 3.961, 3.974, 4.5764, 3.8661, 3.8581, 2.7992, 2.2957, 3.1978, 3.7033, 3.9139, 3.9161, 3.8987, 3.6264, 3.3288, 3.4823, 3.6374, 3.5774, 3.7914, 2.7167, 3.5829, 3.5076, 3.61, 3.2597, 3.6131, 2.8562, 3.5026, 5.2686, 3.6515, 3.3357, 3.6013, 3.9762, 2.8976, 2.707, 4.5378, 3.4658, 3.8183, 3.5137, 3.6841, 4.1161, 4.4597, 3.5921, 4.7121, 3.5458, 3.8956, 3.7309, 2.7701, 4.1336, 4.0906, 4.1777, 4.1872, 4.1467, 4.0519, 4.1261, 4.2709, 4.7793, 4.3104, 4.3821, 3.5926, 4.4513, 4.6318, 4.7108, 4.7706, 4.2936, 5.0553, 5.0575, 5.0184, 5.0049, 5.1069, 5.5348, 5.5354, 5.685, 4.9821]

a0, a1, a2 = best_poly(x, y, 2)

print(f'{a0} , {a1}, {a2}')