import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [-4.4474, -4.3597, -4.3022, -4.1221, -4.0916, -3.9384, -3.8297, -3.763, -3.6779, -3.6036, -3.511, -3.361, -3.2881, -3.2218, -3.1008, -2.9697, -2.8704, -2.8062, -2.6893, -2.5779, -2.5255, -2.3678, -2.2784, -2.2345, -2.0903, -2.0171, -1.9377, -1.8317, -1.7502, -1.6835, -1.4981, -1.419, -1.341, -1.2679, -1.1255, -1.0945, -1.0083, -0.8451, -0.7266, -0.6232, -0.5662, -0.4974, -0.4209, -0.2432, -0.142, -0.1062, 0.0274, 0.1473, 0.2432, 0.2772, 0.4255, 0.5192, 0.6162, 0.6891, 0.7773, 0.9034, 1.023, 1.072, 1.2141, 1.2534, 1.332, 1.4813, 1.6037, 1.6112, 1.7122, 1.81, 1.9203, 2.0146, 2.1295, 2.2145, 2.3401, 2.4498, 2.5469, 2.6622, 2.7649, 2.8083, 2.9137, 3.0552, 3.1539, 3.2081, 3.287, 3.4101, 3.4881, 3.5551, 3.6524, 3.8172, 3.8444, 3.9653, 4.1001, 4.1678, 4.2483, 4.3425, 4.4976, 4.6017, 4.6412, 4.723, 4.8144, 4.9515]
y = [2.5744, 3.3058, 3.949, 4.3146, 4.7565, 6.3581, 5.5028, 6.5638, 5.9719, 6.1188, 6.5792, 6.7792, 6.9336, 6.9726, 7.1154, 6.4007, 6.9875, 6.9714, 7.0832, 6.8009, 7.6069, 6.5318, 6.5867, 6.8755, 6.7123, 5.6241, 6.3504, 5.9915, 5.799, 4.3446, 4.5876, 5.5726, 5.3641, 5.5518, 5.1191, 5.3299, 5.2445, 4.7765, 4.5313, 4.3092, 4.0403, 4.699, 4.5284, 5.4246, 4.2813, 4.6048, 4.3818, 4.3161, 4.0418, 4.4317, 4.6255, 4.7028, 4.5783, 5.7655, 4.9463, 4.8565, 5.1086, 3.4102, 5.3315, 5.3365, 5.4868, 5.7309, 6.1412, 6.6625, 6.0538, 6.3121, 6.3461, 7.3216, 6.783, 7.0672, 7.5999, 8.0196, 7.9024, 7.8161, 8.2004, 8.2279, 7.5709, 8.6698, 10.6241, 8.0256, 9.0377, 8.677, 8.8163, 8.526, 8.4975, 8.779, 10.2735, 8.7662, 10.277, 8.6753, 9.0556, 8.5301, 5.8593, 7.1367, 6.8062, 6.8336, 5.1563, 5.6435]

a0, a1, a2, a3, a4 = best_poly(x, y, 4)

print(f'{a0} , {a1}, {a2}, {a3}, {a4}')