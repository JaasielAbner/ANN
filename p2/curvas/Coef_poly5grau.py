import numpy as np
# import scipy as sp

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinônmio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

x = [-4.2215, -4.117, -3.9977, -3.9596, -3.845, -3.7303, -3.7096, -3.6051, -3.5058, -3.4154, -3.3455, -3.2473, -3.1408, -3.088, -2.9802, -2.8382, -2.7734, -2.6651, -2.6372, -2.4893, -2.3975, -2.343, -2.2158, -2.1767, -2.1025, -1.9955, -1.9439, -1.7894, -1.7205, -1.6398, -1.5702, -1.4209, -1.3908, -1.2993, -1.1648, -1.0872, -1.0542, -0.8874, -0.8754, -0.7574, -0.6602, -0.5595, -0.4464, -0.4362, -0.3319, -0.1916, -0.1449, -0.0115, 0.0339, 0.1008, 0.2302, 0.3409, 0.4307, 0.5203, 0.5349, 0.7007, 0.7426, 0.8829, 0.9495, 1.0121, 1.0932, 1.2019, 1.2462, 1.4129, 1.419, 1.5264, 1.6212, 1.704, 1.8098, 1.8675, 1.9656, 2.0818, 2.1918, 2.2349, 2.3322, 2.4761, 2.5676, 2.5738, 2.657, 2.8133, 2.9202, 2.9636, 3.0648, 3.1367, 3.2376, 3.319, 3.414, 3.5401, 3.6014, 3.6731, 3.7493, 3.8094, 3.9004, 4.0461, 4.1167, 4.1838]
y = [3.4169, 3.9062, 5.0342, 5.0004, 5.7491, 6.0449, 6.2111, 6.2764, 6.6475, 5.9687, 6.6253, 6.4808, 6.5135, 6.6474, 5.8346, 6.4877, 5.9863, 6.239, 6.5339, 5.6708, 5.324, 5.4752, 4.9074, 5.0518, 4.9471, 5.0449, 5.1622, 4.6542, 4.6238, 4.6178, 4.3929, 4.3661, 4.5335, 4.2479, 4.5778, 4.3385, 4.9086, 4.5326, 4.5392, 4.2088, 4.3873, 4.3956, 4.7976, 4.1892, 5.3303, 5.5476, 4.8414, 4.9657, 5.0439, 4.8948, 5.3555, 5.4525, 5.1635, 6.3762, 5.4241, 5.4893, 5.3995, 5.7465, 6.1484, 5.5194, 7.2038, 5.6337, 5.4738, 5.4135, 6.5084, 5.6004, 5.435, 5.48, 5.0336, 4.9892, 4.9959, 4.7073, 4.8677, 4.7523, 4.5918, 4.1906, 4.1598, 4.3536, 3.6506, 3.5494, 1.8617, 2.833, 3.3413, 4.2162, 3.1055, 2.9418, 3.4298, 3.9648, 3.5849, 3.7798, 3.6158, 4.3943, 4.5108, 5.4441, 5.4617, 6.4386]

a0, a1, a2, a3, a4, a5 = best_poly(x, y, 5)

print(f'{a0 } , {a1 }, {a2 }, {a3 }, {a4 }, {a5 }')