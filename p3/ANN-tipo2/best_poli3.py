import numpy as np

def best_parabola(x,y):
    n = len(x)
    xises = 0
    #MATRIZ A
    xises = 0
    xises_quadrado = 0
    xises_cubo = 0
    xises_quarta = 0
    xises_quinta = 0
    xises_sexta = 0
    #MATRIZ B
    yis = 0
    xises_yis = 0
    xises2_yis = 0
    xises3_yis = 0
    for i in range(n):
        #MatrizA
        xises += x[i]
        xises_quadrado += x[i]**2
        xises_cubo +=x[i]**3
        xises_quarta +=x[i]**4
        xises_quinta +=x[i]**5
        xises_sexta +=x[i]**6
        #MatrizB
        yis += y[i]
        xises_yis +=x[i] * y[i]
        xises2_yis += y[i] * (x[i]**2)
        xises3_yis += y[i] * (x[i]**3)



    A = [[n,xises,xises_quadrado,xises_cubo],[xises,xises_quadrado,xises_cubo,xises_quarta],[xises_quadrado,xises_cubo,xises_quarta,xises_quinta],[xises_cubo,xises_quarta,xises_quinta,xises_sexta]]
    B = [yis,xises_yis,xises2_yis,xises3_yis]
    a,b,c,d = np.linalg.solve(A,B)
    return a,b,c,d

x = [-4.8767, -4.7633, -4.6797, -4.5689, -4.4506, -4.212, -4.0745, -4.0441, -3.873, -3.7512, -3.5562, -3.4932, -3.2884, -3.1412, -3.0556, -2.9483, -2.7542, -2.636, -2.5579, -2.428, -2.2021, -2.0774, -1.9742, -1.8486, -1.6743, -1.5837, -1.4022, -1.3577, -1.1553, -1.1007, -0.9332, -0.7194, -0.6893, -0.5633, -0.425, -0.2562, -0.079, 0.0652, 0.1702, 0.2326, 0.406, 0.5276, 0.7273, 0.9011, 1.0301, 1.0794, 1.2124, 1.3299, 1.5085, 1.6498, 1.7156, 1.9429, 2.0796, 2.1281, 2.2631, 2.4342, 2.5857, 2.6532, 2.7828, 2.9233, 3.0869, 3.2085, 3.3257, 3.5634, 3.5931, 3.8064, 3.8614, 4.0293, 4.2332, 4.3225, 4.4349, 4.6016, 4.6842, 4.9257, 5.0435, 5.1345, 5.2297, 5.343, 5.5728, 5.6305, 5.8138, 5.9806]
y = [3.755, 3.9961, 4.3506, 5.4873, 4.7677, 5.2048, 3.8624, 5.8564, 5.5002, 5.1559, 6.1055, 5.6957, 5.7791, 6.154, 6.8052, 7.0356, 6.0108, 5.8931, 5.9288, 5.6624, 5.9521, 5.7352, 5.7925, 5.7177, 5.9239, 5.5763, 5.432, 5.2637, 5.5046, 5.4712, 5.8257, 4.7089, 4.9196, 4.6612, 4.9311, 4.3548, 4.0281, 3.693, 4.1554, 3.7791, 3.9618, 3.5742, 3.3915, 2.7478, 3.4146, 3.0893, 2.8602, 2.8411, 2.538, 3.6557, 3.3907, 3.3753, 2.2845, 2.2067, 2.0465, 1.9831, 2.2049, 2.0571, 2.064, 2.3731, 0.5053, 2.2427, 0.8252, 2.5386, 3.462, 2.7373, 2.5317, 2.7543, 3.4429, 3.19, 3.3847, 4.0025, 3.8802, 4.5704, 4.6652, 5.0443, 5.3286, 5.3535, 7.3303, 6.5754, 7.236, 7.122]

r = best_parabola(x,y)
print(r)
