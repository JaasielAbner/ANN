import numpy as np

def best_parabola(x,y):
    n = len(x)
    xises = 0
    #MATRIZ A
    xises = 0
    xises_quadrado = 0
    xises_cubo = 0
    xises_quarta = 0
    xises_quinta = 0
    xises_sexta = 0
    #MATRIZ B
    yis = 0
    xises_yis = 0
    xises2_yis = 0
    xises3_yis = 0
    for i in range(n):
        #MatrizA
        xises += x[i]
        xises_quadrado += x[i]**2
        xises_cubo +=x[i]**3
        xises_quarta +=x[i]**4
        xises_quinta +=x[i]**5
        xises_sexta +=x[i]**6
        #MatrizB
        yis += y[i]
        xises_yis +=x[i] * y[i]
        xises2_yis += y[i] * (x[i]**2)
        xises3_yis += y[i] * (x[i]**3)
        
    
    
    A = [[n,xises,xises_quadrado,xises_cubo],[xises,xises_quadrado,xises_cubo,xises_quarta],[xises_quadrado,xises_cubo,xises_quarta,xises_quinta],[xises_cubo,xises_quarta,xises_quinta,xises_sexta]]
    B = [yis,xises_yis,xises2_yis,xises3_yis]
    a,b,c,d = np.linalg.solve(A,B)
    return a,b,c,d
# Q5
# x = [-4.9969, -4.3126, -4.0652, -3.5821, -3.1894, -2.9962, -2.6332, -1.9983, -1.8532, -1.2873, -1.0246, -0.7647, -0.3839, 0.1089, 0.4759, 0.8639, 1.3354, 1.4821, 1.9284, 2.3265, 2.6731, 3.223, 3.6963, 4.0778, 4.2389, 4.5534, 4.9446, 5.4872, 5.961]
# y = [2.3809, 3.9934, 4.4562, 5.0624, 5.413, 5.764, 5.6468, 6.0268, 5.7856, 5.739, 3.401, 5.4405, 4.9174, 4.6259, 3.8865, 3.7725, 3.2891, 3.4426, 3.2487, 4.3249, 2.965, 3.6468, 4.0501, 6.0383, 4.9283, 5.6224, 6.9561, 8.3177, 10.1369]
#Q6:
x = [-4.9441, -4.6167, -4.4921, -4.1968, -4.028, -3.7352, -3.6349, -3.4147, -3.1575, -2.9718, -2.694, -2.6284, -2.3869, -2.2172, -2.0013, -1.6876, -1.4358, -1.2144, -1.1624, -0.8376, -0.7204, -0.4105, -0.1846, -0.0416, 0.1897, 0.3449, 0.5626, 0.7249, 0.9692, 1.2463, 1.4874, 1.6017, 1.8896, 2.0023, 2.3023, 2.5341, 2.6754, 2.8494, 3.0746, 3.3398, 3.6452, 3.6934, 3.9305, 4.1145, 4.4222, 4.5584, 4.8688, 5.0391, 5.2649, 5.5659, 5.7279, 5.9204]
y = [1.2033, 2.2927, 2.7194, 3.0755, 3.9441, 4.6102, 3.8692, 5.1466, 4.7899, 4.9977, 5.2482, 6.8924, 5.8934, 5.4, 5.6934, 5.5041, 5.4327, 5.0247, 5.2375, 4.8147, 4.9019, 5.4556, 4.4719, 4.381, 4.2949, 4.0072, 2.8628, 4.0281, 3.8362, 3.5805, 4.0619, 3.8199, 3.458, 3.3687, 3.5925, 3.6554, 5.0633, 3.554, 3.7833, 4.0082, 4.606, 4.3345, 4.7302, 5.1605, 5.8984, 5.5949, 7.3955, 7.5511, 8.8786, 9.0215, 10.4672, 11.6372]

r = best_parabola(x,y)
print(r)