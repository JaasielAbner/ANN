import numpy as np

def best_parabola(x,y):
    n = len(x)
    xises = 0
    #MATRIZ A
    xises = 0
    xises_quadrado = 0
    xises_cubo = 0
    xises_quarta = 0
    xises_quinta = 0
    xises_sexta = 0
    xises_setima = 0
    xises_oitava = 0
    #MATRIZ B
    yis = 0
    xises_yis = 0
    xises2_yis = 0
    xises3_yis = 0
    xises4_yis = 0
    for i in range(n):
        #MatrizA
        xises += x[i]
        xises_quadrado += x[i]**2
        xises_cubo +=x[i]**3
        xises_quarta +=x[i]**4
        xises_quinta +=x[i]**5
        xises_sexta +=x[i]**6
        xises_setima +=x[i]**7
        xises_oitava +=x[i]**8
        #MatrizB
        yis += y[i]
        xises_yis +=x[i] * y[i]
        xises2_yis += y[i] * (x[i]**2)
        xises3_yis += y[i] * (x[i]**3)
        xises4_yis += y[i] * (x[i]**4)
        
    
    
    A = [[n,xises,xises_quadrado,xises_cubo,xises_quarta],[xises,xises_quadrado,xises_cubo,xises_quarta,xises_quinta],
        [xises_quadrado,xises_cubo,xises_quarta,xises_quinta,xises_sexta],[xises_cubo,xises_quarta,xises_quinta,xises_sexta,xises_setima],
        [xises_quarta,xises_quinta,xises_sexta,xises_setima,xises_oitava]]
    B = [yis,xises_yis,xises2_yis,xises3_yis,xises4_yis]
    a,b,c,d,e = np.linalg.solve(A,B)
    return a,b,c,d,e

#Q7:
# x = [-4.3862, -4.1224, -4.0257, -3.916, -3.6452, -3.4535, -3.3114, -3.088, -2.8962, -2.7885, -2.4373, -2.329, -2.1408, -1.9342, -1.7374, -1.4618, -1.2871, -1.1864, -1.0253, -0.8669, -0.6696, -0.4425, -0.2879, -0.0581, 0.165, 0.3089, 0.4564, 0.7142, 0.8918, 1.0618, 1.2627, 1.397, 1.7239, 1.8241, 2.0923, 2.3395, 2.3505, 2.5852, 2.7225, 2.9479, 3.1961, 3.4065, 3.4959, 3.8111, 3.9846, 4.0549, 4.2828, 4.4941, 4.6412, 4.8113]
# y = [2.0469, 4.4322, 5.075, 5.4173, 6.3975, 7.037, 7.3314, 7.6693, 7.9836, 7.6388, 7.479, 7.4585, 5.9909, 6.8241, 7.0818, 6.0247, 5.7163, 5.368, 4.7904, 4.8783, 4.4525, 5.2643, 4.468, 4.2063, 4.2311, 3.9867, 6.0158, 4.6916, 4.8038, 6.5375, 4.5077, 5.9346, 7.0687, 7.0663, 8.4338, 8.1137, 8.002, 8.9437, 9.3252, 9.0081, 11.9669, 10.1572, 9.5124, 9.8184, 10.1702, 10.1685, 9.5195, 7.9728, 7.7456, 6.7978]
#Q8:
x = [-4.4097, -4.1372, -4.0634, -3.7846, -3.6816, -3.4307, -3.4, -3.1729, -2.8888, -2.8151, -2.5806, -2.4272, -2.1523, -2.0648, -1.8311, -1.7433, -1.491, -1.3819, -1.1694, -0.9627, -0.7739, -0.5245, -0.4075, -0.137, -0.0419, 0.1651, 0.3408, 0.5834, 0.7306, 0.8089, 1.0697, 1.2579, 1.3935, 1.6578, 1.7215, 1.9522, 2.2118, 2.3021, 2.5377, 2.6896, 2.8737, 3.1136, 3.2795, 3.4644, 3.6966, 3.8612, 4.0537, 4.1157, 4.3052, 4.513, 4.8034, 4.9541]
y = [2.1997, 4.2772, 4.8446, 5.8722, 4.9159, 6.9989, 7.4448, 7.1235, 7.4763, 7.5718, 7.7675, 7.337, 6.8048, 6.6972, 5.1873, 6.5261, 5.7986, 5.4338, 5.4048, 4.8258, 4.6647, 4.6253, 4.2224, 4.2634, 4.3035, 4.3009, 4.2868, 4.622, 3.6492, 5.6452, 5.2304, 6.4489, 5.5761, 6.014, 7.252, 7.0004, 7.6848, 7.9436, 8.441, 9.6659, 9.3762, 9.7228, 10.073, 10.0745, 10.1339, 10.0859, 10.0369, 10.1351, 8.3353, 7.5844, 6.4991, 5.3371]
r = best_parabola(x,y)
print(r)