import numpy as np

def best_par(x,y):
    n = len(x)
    xises = 0
    #MATRIZ A
    xises = 0
    xises_quadrado = 0
    xises_cubo = 0
    xises_quarta = 0
    #MATRIZ B
    yis = 0
    xises_yis = 0
    xises2_yis = 0
    for i in range(n):
        xises += x[i]
        xises_quadrado += x[i]**2
        xises_cubo +=x[i]**3
        xises_quarta +=x[i]**4
        
        yis += y[i]
        xises_yis +=x[i] * y[i]
        xises2_yis += y[i] * (x[i]**2)
    
    A = [[n,xises,xises_quadrado],[xises,xises_quadrado,xises_cubo],[xises_quadrado,xises_cubo,xises_quarta]]
    B = [yis,xises_yis,xises2_yis]
    a,b,c = np.linalg.solve(A,B)
    return a,b,c

# Q3:
# x = [0.3324, 0.4039, 0.775, 1.117, 1.4345, 1.8739, 2.299, 2.3912, 2.7956, 3.2827, 3.5023, 3.6831, 4.3062, 4.3541, 4.952, 5.2645, 5.461, 5.781, 6.161, 6.5345, 6.7923, 7.0454, 7.5262, 7.7913, 8.2757, 8.5763, 8.846, 9.1713, 9.6539, 9.9284]
# y = [5.1671, 5.1072, 4.3025, 5.0361, 4.7376, 3.8347, 3.7747, 3.5251, 3.6908, 3.4891, 2.6483, 4.0594, 3.2972, 3.9815, 3.5355, 1.881, 3.6431, 3.543, 3.6152, 4.0162, 3.6042, 4.167, 4.588, 4.1211, 3.922, 3.0092, 4.6776, 5.2811, 5.7963, 6.1178]

# Q4:
# x = [0.0731, 0.3214, 0.6954, 0.9247, 1.1681, 1.4979, 1.7839, 2.0336, 2.3696, 2.6065, 2.9471, 3.1619, 3.2912, 3.7261, 3.8987, 4.2719, 4.5036, 4.7966, 5.1235, 5.1461, 5.4238, 5.6834, 5.9563, 6.4773, 6.4867, 6.8552, 7.1433, 7.3457, 7.7251, 7.9564, 8.1717, 8.6478, 8.7052, 8.9848, 9.3375, 9.6637, 9.9629]
# y = [5.5932, 5.216, 5.1792, 5.499, 5.0066, 4.5902, 4.1725, 4.2873, 3.3308, 3.9753, 3.8524, 3.5782, 3.8904, 3.5222, 3.617, 3.4864, 3.9473, 3.6046, 3.8181, 3.8617, 3.9075, 4.097, 4.059, 3.8777, 5.1076, 4.3876, 4.41, 5.1594, 4.9854, 5.2504, 5.2594, 5.3034, 4.5419, 5.7453, 6.2233, 5.7582, 6.5888]

# Q1 Prova:
x = [0.1335, 0.3658, 0.6044, 0.8626, 1.1043, 1.5478, 1.6715, 2.0282, 2.2198, 2.6765, 2.8981, 3.2367, 3.2687, 3.5958, 3.8694, 4.0695, 4.5264, 4.6871, 5.0534, 5.352, 5.4372, 5.843, 6.0986, 6.4214, 6.5741, 6.8808, 7.2243, 7.3471, 7.7424, 7.8397, 8.2662, 8.3895, 8.8107, 9.1457, 9.413, 9.6673, 9.9442]
y = [5.1458, 5.0211, 4.8974, 4.3633, 4.2681, 4.2584, 4.0097, 4.8941, 4.1147, 3.5811, 3.9344, 3.8157, 3.5607, 3.8032, 3.471, 3.3119, 3.4782, 2.6254, 3.4088, 2.6057, 3.7898, 3.5131, 3.5831, 3.6913, 3.5689, 4.1282, 3.0684, 4.9243, 4.2239, 4.8629, 4.4882, 4.5534, 4.6305, 5.1016, 5.8713, 5.4634, 5.8744]



r = best_par(x,y)
print(r)